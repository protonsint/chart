<html>
<style>
td {
    border: 1px solid silver;
    padding: 5px;
}
</style>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>



<script>


$(document).ready(function(){

var getColorForPercentage = function(pct) {

	
	var cfac=(Math.abs(pct)/5);
	
	var ccode=0;
	if(pct<0)
		ccode='rgba(255,0,0,'+cfac+')';
	else
		ccode='rgba(0,255,0,'+cfac+')';
	
	
    return ccode;
    // or output as hex if preferred
}


















function fetchStocks(){





//var bseStocks=['500112','500247'];
//var nseStocks=['SBIN','Grasim', 'tcs', 'bankbaroda', 'adaniports'];



var bseStocks=$("#bseList").val().split(",");
var nseStocks=$("#nseList").val().split(",");




var apiURL="https://www.google.com/finance/info?q="+"BOM:"+bseStocks+",NSE:"+nseStocks;

 $.get(apiURL, function(data, status){
       // alert("Data: " + data.split("//")[1] + "\nStatus: " + status);
		var _data=data.split("//")[1];
		
		var jo = $.parseJSON(_data);

		//alert('The JSON object has this many elements: ' + jo.length);

		// let's make a table out of the first element for fun

		var $table = $('#firstItem');
		
		$table.append("<table><tr><td> Stock ID </td><td> Exchange </td><td> Last Price </td><td> Last Time </td><td> Change  </td><td> Change Percentage </td></tr>");
		
						/*
					id	672834
					t	500112
					e	BOM
					l	231.50
					l_fix	231.50
					l_cur	Rs.231.50
					s	0
					ltt	3:54PM GMT+5:30
					lt	Aug 10, 3:54PM GMT+5:30
					lt_dts	2016-08-10T15:54:37Z
					c	-3.10
					c_fix	-3.10
					cp	-1.32
					cp_fix	-1.32
					ccol	chr
					pcls_fix

					*/


				//t, e, l, lt, c, cp
				
				//alert(jo[i].t)
				
		for(var i=0;i<jo.length;i++){
		//alert(getColorForPercentage(jo[i].cp))
			$table.append("<tr style='background:"+getColorForPercentage(jo[i].cp)+"'><td>"+jo[i].t+"</td><td>"+jo[i].e+"</td><td>"+jo[i].l+"</td><td>"+jo[i].lt+"</td><td>"+jo[i].c+"</td><td>"+jo[i].cp+"</td></tr>");
		
		
		


		/*$.each(jo[i], function (i, val) {
				var $r = $('<tr>');
				var $c = $('<td>').text(i).appendTo($r);
				$c = $('<td>').text(val).appendTo($r);
				$table.append($r);
			});*/
			//$table.append("<tr><td>   --------------------------    </td></tr>");
		}
		
		$table.append("</table>");
});



}


$("#submit_btn").on("click",fetchStocks)



});


</script>


<body>



<table id="firstItem">
</table>


<p>BSE Stocks <input id="bseList" type="text" /></p>
<p>NSE Stocks <input id="nseList" type="text" /></p>
<p><input id="submit_btn" type="submit" value="Submit" /></p>



</body>
</html>